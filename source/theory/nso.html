

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7. Nonlinear Stabilization Operator (NSO) &mdash; Nalu-Wind 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="8. Turbulence Modeling" href="turbulenceModeling.html" />
    <link rel="prev" title="6. RTE Stabilization" href="rteStabilization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Nalu-Wind
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://github.com/Exawind/nalu-wind">Nalu-Wind Homepage</a></li>
<li class="toctree-l1"><a class="reference external" href="http://my.cdash.org/index.php?project=Exawind">Nalu-Wind Nightly Test Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Theory Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="lowMachNumberDerivation.html">1. Low Mach Number Derivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="supportedEquationSet.html">2. Supported Equation Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="discretizationApproach.html">3. Discretization Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="advectionStabilization.html">4. Advection Stabilization</a></li>
<li class="toctree-l2"><a class="reference internal" href="pressureStabilization.html">5. Pressure Stabilization</a></li>
<li class="toctree-l2"><a class="reference internal" href="rteStabilization.html">6. RTE Stabilization</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">7. Nonlinear Stabilization Operator (NSO)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nso-based-on-kinetic-energy-residual">7.1. NSO Based on Kinetic Energy Residual</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local-or-projected-nso-diffusive-flux-coefficient">7.2. Local or Projected NSO Diffusive Flux Coefficient</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-findings">7.3. General Findings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nso-as-a-turbulence-model">7.4. NSO as a Turbulence Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="turbulenceModeling.html">8. Turbulence Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="boundaryConditions.html">9. Supported Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="overset.html">10. Overset</a></li>
<li class="toctree-l2"><a class="reference internal" href="propertyEvaluation.html">11. Property Evaluations</a></li>
<li class="toctree-l2"><a class="reference internal" href="couplingApproach.html">12. Coupling Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeDiscretization.html">13. Time discretization</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiPhysics.html">14. Multi-Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="windEnergy.html">15. Wind Energy Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="topologicalSupport.html">16. Topological Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="adaptivity.html">17. Adaptivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="codeAbstractions.html">18. Code Abstractions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../verification/index.html">Verification Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zrefs.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Nalu-Wind</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Nalu-Wind - Theory Manual</a></li>
      <li class="breadcrumb-item active"><span class="section-number">7. </span>Nonlinear Stabilization Operator (NSO)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/source/theory/nso.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nonlinear-stabilization-operator-nso">
<h1><span class="section-number">7. </span>Nonlinear Stabilization Operator (NSO)<a class="headerlink" href="#nonlinear-stabilization-operator-nso" title="Link to this heading"></a></h1>
<p>An alternative to classic Peclet number blending is the usage of a
discontinuity capturing operator (DCO), or in the low Mach context a
nonlinear stabilization operator (NSO). In this method, an artifical
viscosity is defined that is a function of the local residual and scaled
computational gradients. Viable usages for the NSO can be
advection/diffusion problems in addition to the aforementioned RTE VMS
approach.</p>
<p>The formal finite element kernel for a NSO approach is as follows,</p>
<div class="math notranslate nohighlight" id="equation-nsofemform">
<span class="eqno">(7.1)<a class="headerlink" href="#equation-nsofemform" title="Link to this equation"></a></span>\[\sum_e \int_\Omega \nu(\mathbf{R}) \frac{\partial w}{\partial x_i} g^{ij}
\frac{\partial \phi} {\partial x_j} d\Omega,\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu(\mathbf{R})\)</span> is the artifical viscosity which is a
function of the pde fine-scale residual and <span class="math notranslate nohighlight">\(g^{ij}\)</span> is the
covariant metric tensor).</p>
<p>For completeness, the covariant and contravarient metric tensor are
given by,</p>
<div class="math notranslate nohighlight" id="equation-covariant1">
<span class="eqno">(7.2)<a class="headerlink" href="#equation-covariant1" title="Link to this equation"></a></span>\[g^{ij} = \frac{\partial x_i} {\partial \xi_k}\frac{\partial x_j} {\partial \xi_k},\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-covariant2">
<span class="eqno">(7.3)<a class="headerlink" href="#equation-covariant2" title="Link to this equation"></a></span>\[g_{ij} = \frac{\partial \xi_k} {\partial x_i} \frac{\partial \xi_k} {\partial x_j},\]</div>
<p>where <span class="math notranslate nohighlight">\(\xi = (\xi_1, \xi_2, \xi_3)^T\)</span>. The form of
<span class="math notranslate nohighlight">\(\nu(\mathbf{R})\)</span> currently used is as follows,</p>
<div class="math notranslate nohighlight" id="equation-nuone">
<span class="eqno">(7.4)<a class="headerlink" href="#equation-nuone" title="Link to this equation"></a></span>\[\nu = \sqrt{ \frac{\mathbf{R_k} \mathbf{R_k}}
{\frac {\partial \phi}{\partial x_i} g^{ij} \frac{\partial \phi}{\partial x_j}} }.\]</div>
<p>The classic paper by Shakib ( <span id="id1">[<a class="reference internal" href="../../zrefs.html#id14" title="F. Shakib, T. J. R. Hughes, and J. Zdenek. A new finite element formulation for computational fluids dynamics: the compressible euler and navier stokes equations. Comp. Meth. in App. Mech and Engr., 89:141–219, 1991.">SHZ91</a>]</span>)
represents the genesis of this method which was done in the
accoustically compressible context.</p>
<p>A residual for a classic advection/diffusion/source pde is simply the
fine scale residual computed at the gauss point,</p>
<div class="math notranslate nohighlight" id="equation-nsoresidual1">
<span class="eqno">(7.5)<a class="headerlink" href="#equation-nsoresidual1" title="Link to this equation"></a></span>\[\mathbf{\hat R} = \frac{\partial \rho \phi}{\partial t}
+ \frac{\partial}{\partial x_j} (\rho u_j \phi - \mu^{eff}
\frac{\partial \phi}{\partial x_j}) -S\]</div>
<p>Note that the above equation requires a second derivative whose source
is the diffusion term. The first derivative is generally determined by
using projected nodal gradients. As will be noted in the pressure
stabilization section, the advection term carries the pressure
stabilization terms. However, in the above equation, these terms are not
explicity noted. Therefore, an option is to subtract the fine scale
continuity equation to obtain the final general form of the source term,</p>
<div class="math notranslate nohighlight" id="equation-nsoresidual2">
<span class="eqno">(7.6)<a class="headerlink" href="#equation-nsoresidual2" title="Link to this equation"></a></span>\[\mathbf{R} = \mathbf{\hat R} - \phi (\frac{\partial \rho}{\partial t}
+ \frac{\partial \rho u_j }{\partial x_j}).\]</div>
<p>An alternative to the fine-scale PDE is a form that is found by
differencing the linearized form of the residual from the nonlinear
residual,</p>
<div class="math notranslate nohighlight" id="equation-nsoresidualalt">
<span class="eqno">(7.7)<a class="headerlink" href="#equation-nsoresidualalt" title="Link to this equation"></a></span>\[\mathbf{R} = \frac{\partial \rho u_j \phi }{\partial x_j}
- (\phi \frac{\partial \rho u_j }{\partial x_j} + \rho u_j
\frac{\partial \phi}{\partial x_j}).\]</div>
<p>The above resembles a commutation error in the nonlinear advection
term.</p>
<p>In general, the NSO-<span class="math notranslate nohighlight">\(\nu\)</span> is prone to percision issues when the
gradients are very close to zero. As such, the value of <span class="math notranslate nohighlight">\(\nu\)</span> is
limited to a first-order like value. This parameter is proposed as
follows: if an operator were written as a Galerkin (un-stabilized) plus
a diffusion operator, what is the value of the diffusion coefficient
such that first-order upwind is obtained for the combined operator? This
upwind limited value of <span class="math notranslate nohighlight">\(\nu\)</span> provides the highest value that this
coefficient can (or should) be. The current form of the limited upwind
<span class="math notranslate nohighlight">\(\nu\)</span> is as follows,</p>
<div class="math notranslate nohighlight" id="equation-nsofvform1">
<span class="eqno">(7.8)<a class="headerlink" href="#equation-nsofvform1" title="Link to this equation"></a></span>\[\nu^{upw} = C_{upw}(\rho u_i g_{ij} \rho u_j )^{\frac{1}{2}}\]</div>
<p>where <span class="math notranslate nohighlight">\(C_{upw}\)</span> is generally taked to be  0.1.</p>
<p>Using a piecewise-constant test function suitable for CVFEM and EBVC
schemes (the reader is refered to the VMS RTE section), Eq. <a class="reference internal" href="#equation-nsofemform">(7.1)</a>
can be written as,</p>
<div class="math notranslate nohighlight" id="equation-nsofvform2">
<span class="eqno">(7.9)<a class="headerlink" href="#equation-nsofvform2" title="Link to this equation"></a></span>\[-\sum_e \int_\Gamma \nu(\mathbf{R}) g^{ij} \frac{\partial \phi} {\partial x_j} n_i dS.\]</div>
<p>A fourth order form, which writes the stabilization as the difference
between the Gauss-point gradient and the projected nodal gradient
interpolated to the Gauss-point, is also supported,</p>
<div class="math notranslate nohighlight" id="equation-nsofvform4th">
<span class="eqno">(7.10)<a class="headerlink" href="#equation-nsofvform4th" title="Link to this equation"></a></span>\[-\sum_e \int_\Gamma \nu(\mathbf{R}) g^{ij}
(\frac{\partial \phi} {\partial x_j} - G_j \phi ) n_i dS.\]</div>
<section id="nso-based-on-kinetic-energy-residual">
<h2><span class="section-number">7.1. </span>NSO Based on Kinetic Energy Residual<a class="headerlink" href="#nso-based-on-kinetic-energy-residual" title="Link to this heading"></a></h2>
<p>An alternative formulation explored is to share the general kernal form
shown in Equation <a class="reference internal" href="#equation-nsofvform4th">(7.10)</a>, however, compute <span class="math notranslate nohighlight">\(\nu\)</span> based on
a fine-scale kinetic energy residual. In this formulation, the
fine-scale kinetic energy residual is obtained from the fine-scale
momentum residual dotted with velocity. As with the continuity
stabilization approach, the fine-scale momentum residual is provided by
Equation <a class="reference internal" href="#equation-finescaleke">(7.11)</a>. Therefore, the fine-scale kinetic energy
is written as,</p>
<div class="math notranslate nohighlight" id="equation-finescaleke">
<span class="eqno">(7.11)<a class="headerlink" href="#equation-finescaleke" title="Link to this equation"></a></span>\[\mathbf{R}_{ke} = \frac{u_j(\frac{\partial p} {\partial x_j} - G_j p )}{2},\]</div>
<p>while the denominator for <span class="math notranslate nohighlight">\(\nu\)</span> now includes the gradient in ke,</p>
<div class="math notranslate nohighlight" id="equation-nuke">
<span class="eqno">(7.12)<a class="headerlink" href="#equation-nuke" title="Link to this equation"></a></span>\[\nu = \sqrt{ \frac{\mathbf{R}_{ke} \mathbf{R}_{ke}}
{\frac {\partial ke}{\partial x_i} g^{ij} \frac{\partial ke}{\partial x_j}} }.\]</div>
<p>The kinetic energy is simply given by,</p>
<div class="math notranslate nohighlight" id="equation-keform">
<span class="eqno">(7.13)<a class="headerlink" href="#equation-keform" title="Link to this equation"></a></span>\[ke = \frac{u_k u_k}{2}\]</div>
<p>The kinetic energy form of <span class="math notranslate nohighlight">\(\nu\)</span> is used for all equation sets
with transformation by usage of a turbulent Schmidt/Prandtl number.</p>
</section>
<section id="local-or-projected-nso-diffusive-flux-coefficient">
<h2><span class="section-number">7.2. </span>Local or Projected NSO Diffusive Flux Coefficient<a class="headerlink" href="#local-or-projected-nso-diffusive-flux-coefficient" title="Link to this heading"></a></h2>
<p>While the NSO kernel is certainly evaluated at the subcontrol surfaces,
the evaluation of <span class="math notranslate nohighlight">\(\nu\)</span> can be computed by a multitude of
approaches. For example, the artificial diffusive flux coefficient can
be computed locally (with local residuals and local metric tensors) or
can be projected to the nodes (via an <span class="math notranslate nohighlight">\(L_{oo}\)</span> or <span class="math notranslate nohighlight">\(L_2\)</span>
projection) and re-interpolated to the gauss points. The former results
in a sharper local value while the later results in a more filtered-like
value. The code base only supports a local NSO <span class="math notranslate nohighlight">\(\nu\)</span> calculation.</p>
</section>
<section id="general-findings">
<h2><span class="section-number">7.3. </span>General Findings<a class="headerlink" href="#general-findings" title="Link to this heading"></a></h2>
<p>In general, the NSO approach seems to work best when running the
fourth-order option as the second-order implementation still looks more
diffuse. When compared to the standard MUSCL-limited scheme, the NSO is
the preferred choice. More work is underway to improve stabilization
methods. Note that a limited set of NSOs are activated in the code base
with specific interest on scalar transport, e.g, momentum, mixture
fraction and static enthalpy transport. When using the <span class="math notranslate nohighlight">\(4^{th}\)</span>
order method, the consistent mass matrix approach for the projected
nodal gradients is supported for higher order.</p>
</section>
<section id="nso-as-a-turbulence-model">
<h2><span class="section-number">7.4. </span>NSO as a Turbulence Model<a class="headerlink" href="#nso-as-a-turbulence-model" title="Link to this heading"></a></h2>
<p>The kinetic energy residual form has been suggested to be used as a turbulence model (Guermond and Larios, 2015). However,
inspection of the above NSO kernel form suggests that the model form is not symmetric. Rather, in the context of
turbulence modeling, is closer to the metric tensor acting on the difference between the rate of strain and antisymmetric
tensor. As such, the theory developed, e.g., for eigenvalue perturbations of the stress tensor (see Jofre and Domino, 2017) can not be applied. In this section,
a new form of the NSO is provided in an effort to be used for an LES closure.</p>
<p>In this proposed NSO formulation, the subgrid stress tensor, <span class="math notranslate nohighlight">\(\tau^{sgs}_{ij} = \overline{u_i u_j} - \bar u_i \bar u_j\)</span>,
is given by,</p>
<div class="math notranslate nohighlight" id="equation-nsoturbform">
<span class="eqno">(7.14)<a class="headerlink" href="#equation-nsoturbform" title="Link to this equation"></a></span>\[\tau^{sgs}_{ij} = - 2 \rho \nu g^{ij} (S_{ij} -
\frac{1}{3}\frac{\partial u_k} {\partial x_k} \delta_{ij})
= - 2 \rho \nu g^{ij} S^*_{ij}.\]</div>
<p>Interestingly, the units of <span class="math notranslate nohighlight">\(\nu\)</span> are of an inverse time scale while the product <span class="math notranslate nohighlight">\(2 \rho \nu g^{ij}\)</span> can be viewed
as an non-isotropic eddy viscosity, <span class="math notranslate nohighlight">\(\mu^t_{ij}\)</span>.</p>
<p>The first order clipping may be relaxed by defining <span class="math notranslate nohighlight">\(\nu\)</span> as,</p>
<div class="math notranslate nohighlight" id="equation-nuturb">
<span class="eqno">(7.15)<a class="headerlink" href="#equation-nuturb" title="Link to this equation"></a></span>\[\nu = \frac{| \mathbf{R}_{ke} |} {||ke||_\infty}.\]</div>
<p>The above form would be closer to what Guermond uses and would avoid the divide-by-zero noted in regions of uniform flow.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rteStabilization.html" class="btn btn-neutral float-left" title="6. RTE Stabilization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="turbulenceModeling.html" class="btn btn-neutral float-right" title="8. Turbulence Modeling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>